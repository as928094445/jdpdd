(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/detail"],{"3c52":function(t,o,e){},"485d":function(t,o,e){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=e("2f62"),i=u(e("0d04")),s=u(e("8846"));function u(t){return t&&t.__esModule?t:{default:t}}function r(t,o){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable}))),e.push.apply(e,n)}return e}function c(t){for(var o=1;o<arguments.length;o++){var e=null!=arguments[o]?arguments[o]:{};o%2?r(Object(e),!0).forEach((function(o){a(t,o,e[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):r(Object(e)).forEach((function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))}))}return t}function a(t,o,e){return o in t?Object.defineProperty(t,o,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[o]=e,t}var l=function(){e.e("components/tui-skeleton/tui-skeleton").then(function(){return resolve(e("28a7"))}.bind(null,e)).catch(e.oe)},d=function(){e.e("components/icon/icon").then(function(){return resolve(e("11d2"))}.bind(null,e)).catch(e.oe)},p=function(){e.e("components/tag/tag").then(function(){return resolve(e("382c"))}.bind(null,e)).catch(e.oe)},h=function(){e.e("components/badge/badge").then(function(){return resolve(e("9b19"))}.bind(null,e)).catch(e.oe)},f=function(){e.e("components/nomore/nomore").then(function(){return resolve(e("19b2"))}.bind(null,e)).catch(e.oe)},g=function(){e.e("components/button/button").then(function(){return resolve(e("6d63"))}.bind(null,e)).catch(e.oe)},m=function(){e.e("components/top-dropdown/top-dropdown").then(function(){return resolve(e("7deb"))}.bind(null,e)).catch(e.oe)},b=function(){e.e("components/bottom-popup/bottom-popup").then(function(){return resolve(e("9d80"))}.bind(null,e)).catch(e.oe)},_=function(){e.e("components/numberbox/numberbox").then(function(){return resolve(e("b6e2"))}.bind(null,e)).catch(e.oe)},v=function(){e.e("components/divider/divider").then(function(){return resolve(e("d835"))}.bind(null,e)).catch(e.oe)},w=function(){e.e("components/loadmore/loadmore").then(function(){return resolve(e("1d98"))}.bind(null,e)).catch(e.oe)},y=function(){e.e("components/modal/modal").then(function(){return resolve(e("4d2f"))}.bind(null,e)).catch(e.oe)},O={computed:(0,n.mapState)(["isLogin","authKey","userInfo","allianceType","allianceName","isApprove"]),components:{tuiSkeleton:l,tuiIcon:d,tuiTag:p,tuiBadge:h,tuiNomore:f,tuiButton:g,tuiTopDropdown:m,tuiBottomPopup:b,tuiNumberbox:_,tuiDivider:v,tuiLoadmore:w,tuiModal:y},data:function(){return{skeletonShow:!0,height:64,top:0,scrollH:0,opcity:0,iconOpcity:.5,good_id:0,is_get_goods:!1,goods_name:"",coupon_discount:0,sales_tip:0,goods:{min_group_price:0,sales_tip:0,price_1:"00",price_2:"00"},weAppInfo:{},banner:[],bannerIndex:0,topMenu:[{icon:"home",text:"首页",size:23,badge:0,path:"./mall"},{icon:"people",text:"我的",size:26,badge:0,path:"./user/my"}],menuShow:!1,popupShow:!1,value:1,collected:!1,mallGoods:[],productList:[],pageIndex:1,loadding:!1,pullUpOn:!0,wenAn:"欢迎使用~",posterShow:!1,posterSaveStatus:!1,posterUrl:"",askPoster:!1,schema_url:"",web_url:""}},watch:{isLogin:function(){this.isLogin&&this.getInfo()}},onShow:function(){},onLoad:function(o){var e=this,n={};if(n=wx.getMenuButtonBoundingClientRect(),setTimeout((function(){t.getSystemInfo({success:function(t){e.width=n.left||t.windowWidth,e.height=n.top?n.top+n.height+8:t.statusBarHeight+44,e.top=n.top?n.top+(n.height-32)/2:t.statusBarHeight+6,e.scrollH=t.windowWidth}})}),50),o.pid&&this.setPid(o.pid),this.good_id=o.good_id,o.goods){var i=JSON.parse(unescape(o.goods));this.goods=i,this.goods_name=i.goods_name,this.banner=this.banner.concat([i.img])}o.shopType&&this.setAllianceType(o.shopType),this.getInfo()},methods:c(c({},(0,n.mapMutations)(["setPid","setAllianceType"])),{},{bannerChange:function(t){this.bannerIndex=t.detail.current},previewImage:function(o){var e=o.currentTarget.dataset.index;t.previewImage({current:this.banner[e],urls:this.banner})},back:function(){t.navigateBack()},openMenu:function(){this.menuShow=!0},closeMenu:function(){this.menuShow=!1},showPopup:function(){var o=this;o.is_get_goods?o.popupShow=!0:(t.showLoading({title:"加载中"}),o.getInfo((function(){o.popupShow=!0})))},hidePopup:function(){this.popupShow=!1},change:function(t){this.value=t.value},collecting:function(){this.collected=!this.collected},common:function(o){if(o>=0){var e=this.topMenu[o].path;t.switchTab({url:e})}else this.tui.toast("功能开发中~")},submit:function(){this.popupShow=!1,t.navigateTo({url:"../mall-extend/submitOrder/submitOrder"})},detail:function(o,e){var n=e>=0?"&goods="+escape(JSON.stringify(this.productList[e])):"";t.navigateTo({url:"./detail?good_id="+o+n})},goBuy:function(){var o=this;o.getInfo((function(){t.navigateToMiniProgram({appId:o.weAppInfo.app_id,path:o.weAppInfo.page_path,extraData:{title:o.goods_name},success:function(t){console.log(t)},fail:function(t){console.log(t)}})}))},getInfo:function(o){var e=this;if(e.is_get_goods)return o(),void t.hideLoading();e.$http.post("/detail",{goods_id:this.good_id,coupon_link:this.goods.coupon_link,askPoster:this.askPoster}).then((function(n){if(200==n.data.ret){e.is_get_goods=!0;var i=n.data.data;if(i.goods_detail){var s=i.goods_detail;e.goods=s,e.goods_name=s.goods_name,s.goods_gallery_urls&&(e.banner=e.banner.concat(s.goods_gallery_urls)),e.mallGoods=i.mall_goods?i.mall_goods:[],e.skeletonShow=!1}e.posterUrl=i.poster,i.wenAn&&(e.wenAn=i.wenAn),e.weAppInfo=i.we_app_info,e.web_url=i.view_short_url,e.schema_url="iOS"===plus.os.name&&"jd"==e.allianceType?i.schema_url_ios:i.schema_url,o&&(o(),t.hideLoading())}else t.hideLoading()})).catch((function(o){404==o.data.ret&&t.showToast({title:o.data.msg,icon:"none",duration:3e3,success:function(){t.switchTab({url:"./mall"})}}),t.hideLoading(),console.log(o)}))},copyData:function(){i.default.getClipboardData(this.wenAn,(function(t){}))},showPoster:function(){var o=this;o.is_get_goods&&o.askPoster?o.posterShow=!0:(t.showLoading({title:"生成中"}),o.askPoster=!0,o.is_get_goods=!1,o.getInfo((function(){o.posterShow=!0})))},hidePoster:function(){this.posterShow=!1},posterPreview:function(){t.previewImage({current:1,urls:[this.posterUrl]})},savePoster:function(){s.default.savePoster(this,this.posterUrl)}}),onPageScroll:function(t){var o=t.scrollTop<=0?0:t.scrollTop,e=o/this.scrollH;this.opcity>=1&&e>=1||(this.opcity=e,this.iconOpcity=.5*(1-e<0?0:1-e))},onPullDownRefresh:function(){setTimeout((function(){t.stopPullDownRefresh()}),200)},onReachBottom:function(){if(this.pullUpOn&&this.goods_name){this.loadding=!0;var t=this;s.default.getSearch({keyword:t.goods_name,pages:t.pageIndex,fenci:1,withCoupon:!1},(function(o){var e=o.list,n=o.next;0==n&&(t.pullUpOn=!1),1==t.pageIndex&&(t.productList=[]),t.productList=t.productList.concat(e),t.pageIndex=t.pageIndex+1,t.loadding=!1}))}},onShareAppMessage:function(t){if("button"===t.from&&console.log(t.target),this.good_id){var o="/pages/detail?good_id="+this.good_id+"&shopType="+this.allianceType;this.isLogin&&(o+="&pid="+this.userInfo.id);var e="原价:￥"+this.goods.quanhou_price+" "+this.goods_name;return this.goods.coupon_discount>0&&(e="券后:￥"+this.goods.quanhou_price+" 原价:￥"+this.goods.min_group_price+" "+this.goods_name),console.log(o),{title:e,imageUrl:this.goods.img,content:"转发推广赚佣金",desc:"推广赚佣金",path:o}}}};o.default=O}).call(this,e("543d")["default"])},5188:function(t,o,e){"use strict";e.r(o);var n=e("485d"),i=e.n(n);for(var s in n)"default"!==s&&function(t){e.d(o,t,(function(){return n[t]}))}(s);o["default"]=i.a},"941b":function(t,o,e){"use strict";e.d(o,"b",(function(){return i})),e.d(o,"c",(function(){return s})),e.d(o,"a",(function(){return n}));var n={tuiSkeleton:function(){return e.e("components/tui-skeleton/tui-skeleton").then(e.bind(null,"28a7"))}},i=function(){var t=this,o=t.$createElement;t._self._c},s=[]},cb5e:function(t,o,e){"use strict";(function(t){e("908c");n(e("66fd"));var o=n(e("f208"));function n(t){return t&&t.__esModule?t:{default:t}}t(o.default)}).call(this,e("543d")["createPage"])},e39d:function(t,o,e){"use strict";var n=e("3c52"),i=e.n(n);i.a},f208:function(t,o,e){"use strict";e.r(o);var n=e("941b"),i=e("5188");for(var s in i)"default"!==s&&function(t){e.d(o,t,(function(){return i[t]}))}(s);e("e39d");var u,r=e("f0c5"),c=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],u);o["default"]=c.exports}},[["cb5e","common/runtime","common/vendor"]]]);